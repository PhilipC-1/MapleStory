<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>ÂºìÁÆ≠Êâã</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      padding: 20px;
      color: #333;
      font-weight: bold;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    #floating-points {
      text-align: center;
      font-size: 22px;
      margin-bottom: 20px;
    }
    #points-remaining {
      color: red;
    }
    .skills-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
    }
    .skill {
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 0 10px #ccc;
      padding: 20px;
      box-sizing: border-box;
      width: calc(33.333% - 20px);
      min-width: 280px;
      flex-grow: 1;
      position: relative;
    }
    @media (max-width: 768px) {
      .skill {
        width: calc(50% - 20px);
      }
    }
    .unlock-status {
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 16px;
      font-weight: bold;
    }
    .unlock-status.locked {
      color: #a0522d;
    }
    .unlock-status.unlocked {
      color: green;
    }
    .skill-header {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
    .skill-header img {
      width: 64px;
      height: 64px;
      margin-right: 15px;
    }
    .skill-header h2 {
      margin: 0;
    }
    .meta-table, .skill-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      table-layout: fixed;
    }
    .meta-table td, .skill-table td, .skill-table th {
      padding: 6px 10px;
      border: 1px solid #ccc;
      text-align: center;
      vertical-align: middle;
      word-wrap: break-word;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .meta-table td.label {
      background: #e6f5ff;
      width: 100px;
    }
    .effect-row td.label {
      background: #fff8dc;
    }
    .effect-row td.effect {
      background: #fff;
      white-space: pre-wrap;
    }
    .controls {
      margin-top: 15px;
      text-align: left;
    }
    button {
      font-size: 18px;
      padding: 5px 12px;
      margin: 0 5px;
      cursor: pointer;
      background-color: #4caf50;
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: bold;
    }
    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
    .skill-table th {
      background-color: #f3e6ff;
    }
    tr.highlight {
      background-color: #d4f0ff;
    }
  </style>
</head>
<body>
  <h1>ÂºìÁÆ≠Êâã</h1>
  <div id="floating-points">ÂèØÁî®ÊäÄËÉΩÈªûÊï∏Ôºö<span id="points-remaining">61</span></div>
  <div id="skills-container" class="skills-grid"></div>

  <script>
    const MAX_POINTS = 61;
    let usedPoints = 0;
    let holdInterval = null;
    let holdTimeout = null;
    let lastWarning = '';

    const skills = [
      {
        name: "Á≤æÊ∫ñÂº∑Âåñ",
        image: "https://maple.yampiz.com/maple/custom/skill/sk_01001.png",
        max_level: 16,
        type: "Ë¢´Âãï",
        prerequisite: "",
        description: "Â¢ûÂä†ÂëΩ‰∏≠Áéá„ÄÇ",
        headers: ["ÊäÄËÉΩÁ≠âÁ¥ö", "ÂëΩ‰∏≠Áéá"],
        levels: Array.from({ length: 16 }, (_, i) => [i + 1, `+${i + 1}`])
      },
      {
        name: "ÁôæÊ≠•Á©øÊ•ä",
        image: "https://maple.yampiz.com/maple/custom/skill/sk_01002.png",
        max_level: 8,
        type: "Ë¢´Âãï",
        prerequisite: "Á≤æÊ∫ñÂº∑Âåñ LV3",
        description: "Â¢ûÂä†ÂºìÊàñÂº©ÂºìÁöÑÂ∞ÑÁ®ãË∑ùÈõ¢„ÄÇ",
        headers: ["ÊäÄËÉΩÁ≠âÁ¥ö", "Â∞ÑÁ®ã"],
        levels: Array.from({ length: 8 }, (_, i) => [i + 1, `${25 * (i + 1)}%`])
      },
      {
        name: "Èú∏ÁéãÁÆ≠",
        image: "https://maple.yampiz.com/maple/custom/skill/sk_01003.png",
        max_level: 20,
        type: "Ë¢´Âãï",
        prerequisite: "",
        description: "ÊîªÊìä‰∏≠Êúâ‰∏ÄÂÆöÊ©üÁéáÁôºÂãïËá¥ÂëΩ‰∏ÄÊìäÔºå\nÂ¢ûÂä†Âõ∫ÂÆöÈ°çÂ§ñÂÇ∑ÂÆ≥„ÄÇ",
        headers: ["ÊäÄËÉΩÁ≠âÁ¥ö", "ÁôºÂãïÁéá", "ÁàÜÊìäÈ°çÂ§ñÂÇ∑ÂÆ≥"],
        levels: Array.from({ length: 20 }, (_, i) => [i + 1, `${2 * (i + 1)}%`, `${5 * (i + 1)}%`])
      },
      {
        name: "ÈõÜ‰∏≠Ë°ì",
        image: "https://maple.yampiz.com/maple/custom/skill/sk_01004.png",
        max_level: 20,
        type: "‰∏ªÂãï",
        prerequisite: "Á≤æÊ∫ñÂº∑Âåñ LV3",
        description: "‰∏ÄÂÆöÊôÇÈñìÂÖßÂ¢ûÂä†ÂëΩ‰∏≠ËàáËø¥ÈÅøÁéá„ÄÇ",
        headers: ["ÊäÄËÉΩÁ≠âÁ¥ö", "Ê∂àËÄóMP", "ÂëΩ‰∏≠Áéá", "Ëø¥ÈÅøÁéá", "ÊåÅÁ∫åÊôÇÈñì"],
        levels: Array.from({ length: 20 }, (_, i) => {
          const val = i + 1;
          return [val, i < 10 ? 8 : 16, `+${val}`, `+${val}`, `${60 + val * 10}Áßí`];
        })
      },
      {
        name: "Êñ∑È≠ÇÁÆ≠",
        image: "https://maple.yampiz.com/maple/custom/skill/sk_01005.png",
        max_level: 20,
        type: "‰∏ªÂãï",
        prerequisite: "",
        description: "ÁôºÂ∞ÑÂº∑ÂäõÁÆ≠Áü¢ÔºåÈÄ†ÊàêÈ´òÂÇ∑ÂÆ≥„ÄÇ",
        headers: ["ÊäÄËÉΩÁ≠âÁ¥ö", "Ê∂àËÄóMP", "ÊîªÊìäÂäõ"],
        levels: [
          [1, 6, "141%"], [2, 6, "146%"], [3, 6, "151%"], [4, 6, "156%"], [5, 7, "164%"],
          [6, 7, "169%"], [7, 7, "174%"], [8, 8, "182%"], [9, 8, "187%"], [10, 9, "195%"],
          [11, 9, "200%"], [12, 10, "208%"], [13, 10, "213%"], [14, 11, "221%"], [15, 11, "226%"],
          [16, 12, "234%"], [17, 12, "239%"], [18, 13, "247%"], [19, 13, "252%"], [20, 14, "260%"]
        ]
      },
      {
        name: "‰∫åÈÄ£ÁÆ≠",
        image: "https://maple.yampiz.com/maple/custom/skill/sk_01006.png",
        max_level: 20,
        type: "‰∏ªÂãï",
        prerequisite: "Êñ∑È≠ÇÁÆ≠ LV1",
        description: "‰∏ÄÊ¨°ÁôºÂ∞ÑÂÖ©ÊûùÁÆ≠ÈÄ≤Ë°åÈõôÈáçÊîªÊìä„ÄÇ",
        headers: ["ÊäÄËÉΩÁ≠âÁ¥ö", "Ê∂àËÄóMP", "ÊîªÊìäÂäõ"],
        levels: [
          [1, 8, "76% x2"], [2, 8, "78% x2"], [3, 8, "80% x2"], [4, 8, "82% x2"], [5, 9, "86% x2"],
          [6, 9, "88% x2"], [7, 9, "90% x2"], [8, 10, "94% x2"], [9, 10, "96% x2"], [10, 11, "100% x2"],
          [11, 11, "102% x2"], [12, 12, "106% x2"], [13, 12, "108% x2"], [14, 13, "112% x2"], [15, 13, "114% x2"],
          [16, 14, "118% x2"], [17, 14, "120% x2"], [18, 15, "124% x2"], [19, 15, "126% x2"], [20, 16, "130% x2"]
        ]
      }
    ];

    const levels = {};
    skills.forEach(skill => levels[skill.name] = 0);

    function updatePoints() {
      const total = Object.values(levels).reduce((a, b) => a + b, 0);
      usedPoints = total;
      document.getElementById("points-remaining").innerText = MAX_POINTS - usedPoints;
      updateUnlockStatus();
    }

    function updateUnlockStatus() {
      skills.forEach(skill => {
        const [preSkill, preLevel] = skill.prerequisite?.match(/(.+?) LV(\d+)/)?.slice(1) || [];
        const unlocked = !preSkill || (levels[preSkill] >= parseInt(preLevel));
        const statusDiv = document.getElementById(`unlock-${skill.name}`);
        if (!unlocked && levels[skill.name] > 0) {
          levels[skill.name] = 0;
          document.getElementById(`level-${skill.name}`).innerText = `Lv. 0`;
          skill.levels.forEach((_, i) => {
            const row = document.getElementById(`row-${skill.name}-${i}`);
            if (row) row.classList.remove("highlight");
          });
        }
        if (statusDiv) {
          statusDiv.textContent = `[${unlocked ? "Â∑≤Ëß£Èéñüîì" : "Êú™Ëß£Èéñüîí"}]`;
          statusDiv.className = `unlock-status ${unlocked ? "unlocked" : "locked"}`;
        }
      });
    }

    function changeLevel(name, delta) {
      const skill = skills.find(s => s.name === name);
      if (!skill) return;
      const newLevel = levels[name] + delta;
      if (newLevel < 0 || newLevel > skill.max_level) return;
      const [reqSkill, reqLv] = skill.prerequisite?.match(/(.+?) LV(\d+)/)?.slice(1) || [];
      if (reqSkill && levels[reqSkill] < parseInt(reqLv)) {
        if (lastWarning !== name) {
          alert(`ÈúÄË¶ÅÂâçÁΩÆÊäÄËÉΩ„Äå${reqSkill}„ÄçËá≥Â∞ëÁ≠âÁ¥ö ${reqLv}`);
          lastWarning = name;
        }
        return;
      }
      const projectedTotal = Object.entries(levels).reduce((sum, [key, val]) => sum + (key === name ? newLevel : val), 0);
      if (projectedTotal > MAX_POINTS) {
        if (lastWarning !== 'overflow') {
          alert(`Ââ©È§òÈªûÊï∏‰∏çË∂≥ÔºåÊúÄÂ§öÂè™ËÉΩ‰ΩøÁî® ${MAX_POINTS} ÈªûÊäÄËÉΩÈªûÔºÅ`);
          lastWarning = 'overflow';
        }
        return;
      }
      levels[name] = newLevel;
      document.getElementById(`level-${name}`).innerText = `Lv. ${newLevel}`;
      skill.levels.forEach((_, i) => {
        const row = document.getElementById(`row-${name}-${i}`);
        if (row) row.classList.toggle("highlight", i === newLevel - 1);
      });
      updatePoints();
    }

    function startHold(name, delta) {
      changeLevel(name, delta);
      holdTimeout = setTimeout(() => {
        holdInterval = setInterval(() => changeLevel(name, delta), 100);
      }, 300);
    }

    function stopHold() {
      clearTimeout(holdTimeout);
      clearInterval(holdInterval);
    }

    function renderSkill(skill) {
      const [preSkill, preLevel] = skill.prerequisite?.match(/(.+?) LV(\d+)/)?.slice(1) || [];
      const isUnlocked = !preSkill || (levels[preSkill] >= parseInt(preLevel));
      const unlockHTML = preSkill
        ? `<div class="unlock-status ${isUnlocked ? 'unlocked' : 'locked'}" id="unlock-${skill.name}">
            [${isUnlocked ? "Â∑≤Ëß£Èéñüîì" : "Êú™Ëß£Èéñüîí"}]
          </div>` : "";
      return `
        <div class="skill">
          ${unlockHTML}
          <div class="skill-header">
            <img src="${skill.image}" alt="${skill.name}" />
            <h2>${skill.name}</h2>
          </div>
          <table class="meta-table">
            <tr>
              <td class="label">È°ûÂûã</td><td>${skill.type}</td>
              <td class="label">ÂâçÁΩÆÊäÄËÉΩ</td><td colspan="2">${skill.prerequisite || "ÁÑ°"}</td>
            </tr>
            <tr class="effect-row">
              <td class="label">ÊäÄËÉΩÊïàÊûú</td>
              <td class="effect" colspan="4">${skill.description.replace(/\n/g, "<br>")}</td>
            </tr>
          </table>
          <div class="controls">
            <button onmousedown="startHold('${skill.name}', -1)" onmouseup="stopHold()" onmouseleave="stopHold()">-</button>
            <span id="level-${skill.name}">Lv. 0</span>
            <button onmousedown="startHold('${skill.name}', 1)" onmouseup="stopHold()" onmouseleave="stopHold()">+</button>
          </div>
          <table class="skill-table">
            <thead>
              <tr>${skill.headers.map(h => `<th>${h}</th>`).join('')}</tr>
            </thead>
            <tbody>
              ${skill.levels.map((row, i) =>
                `<tr id="row-${skill.name}-${i}">${row.map(cell => `<td>${cell}</td>`).join('')}</tr>`
              ).join('')}
            </tbody>
          </table>
        </div>`;
    }

    function renderAll() {
      document.getElementById("skills-container").innerHTML = skills.map(renderSkill).join('');
      updatePoints();
    }

    renderAll();
  </script>
</body>
</html>
